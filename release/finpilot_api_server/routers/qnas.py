from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from DB import schemas, crud
from DB.database import get_db
from DB import schemas, crud
from .response.query import query_non_image, query_image
import pickle
from datetime import datetime, timezone

qna_router = APIRouter()

error_image = "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"

# -------------------
# 질문 기록 CRUD 엔드포인트 및 모델 연동
# -------------------
# @router.post("/", response_model=schemas.QnA)
@qna_router.post("/")
async def create_qna(qna: schemas.QnACreate, db: Session = Depends(get_db)):
    """
    QnA creation endpoint:
    1. 세션 확인 또는 생성
    2. 모델 호출 (질문과 session_id 전달)
    3. QnA 데이터 생성 및 저장
    """
    try:
        # 1. 세션이 존재하는지 확인하거나 생성
        session = crud.create_session(
            db=db,
            user_email=qna.user_email,
            docs_id=qna.docs_id,
        )

        # 2. 모델 호출 (외부 서비스 연동) - chat_option에 따라 다른 함수 호출
        try:
            if "데이터 시각화" in qna.chat_option:
                # 데이터 시각화 요청인 경우 query_image 호출
                graph_response = await query_image(
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    pilot=qna_router.pilot
                )
                
                # 모델에서 반환된 전체 JSON 응답 저장
                answer = graph_response  # 전체 JSON 그대로 저장
                
            else:
                # 일반 질문 처리
                answer = await query_non_image(
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    pilot=qna_router.pilot
                )

                # 3. QnA 데이터 생성 및 저장 (session_id 및 chat_option 포함)
                new_qna = crud.create_qna(
                    db=db,
                    user_email=qna.user_email,
                    docs_id=qna.docs_id,
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    source=answer["source"],
                    answer=answer["answer"]
                )
                
                return new_qna  # 프론트엔드로 그대로 전달
            
        except Exception as e:
            if "데이터 시각화" in qna.chat_option and 'recursion' in str(e).lower():
                qna_response = {
                "images": [
                    {
                    "file_name": "error.png",
                    "image_data": error_image,
                    "source": [],
                    "exception": str(e),
                    }
                ]
                }
            elif 'recursion' in str(e).lower():
                qna_response = {
                    "answer": "관련 정보를 찾을 수 없습니다. 다른 질문을 해주세요.",
                    "source": [],
                    "ask_time": datetime.now(timezone.utc),
                    "exception": str(e),
                }
            else:
                HTTPException(status_code=500, detail=str(e))  # 서버 에러 처리
            return qna_response
        return answer

    except ValueError as ve:
        raise HTTPException(status_code=400, detail=str(ve))  # 잘못된 입력 처리
    except Exception as e:
        if "데이터 시각화" in qna.chat_option and 'recursion' in str(e).lower():
            qna_response = {
            "images": [
                {
                "file_name": "error.png",
                "image_data": error_image,
                "source": [],
                "exception": str(e),
                }
            ]
            }
        elif 'recursion' in str(e).lower():
            qna_response = {
                "answer": "관련 정보를 찾을 수 없습니다. 다른 질문을 해주세요.",
                "source": [],
                "ask_time": datetime.now(timezone.utc),
                "exception": str(e),
            }
        else:
            HTTPException(status_code=500, detail=str(e))  # 서버 에러 처리
        return qna_response