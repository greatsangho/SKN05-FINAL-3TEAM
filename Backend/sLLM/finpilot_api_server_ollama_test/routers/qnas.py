from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from DB import schemas, crud
from DB.database import get_db
from DB import schemas, crud
from .response.query import query_non_image, query_image
import pickle
from datetime import datetime, timezone

qna_router = APIRouter()

error_image = "iVBORw0KGgoAAAANSUhEUgAAA5sAAAGQCAYAAAAgM3T6AAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAZ25vbWUtc2NyZWVuc2hvdO8Dvz4AAABEaVRYdENyZWF0aW9uIFRpbWUAAAAAADIwMjXrhYQgMDLsm5QgMDjsnbwgKO2GoCkg7Jik7ZuEIDA07IucIDUw67aEIDAw7LSI3mX9ZgAAIABJREFUeJzs3XWUVHUDxvHvzGyyyy6xsLR0SkojIBJSKkqjAooiKKGEooACwisoBoKCgIKUgRJSigpISZcs3Q27bNfsxH3/2JVQatm7IT6fcziHnbjzm5k7997nlxa73W4gIiIiIiIiYiJrZhdARERERERE7j0KmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKmU9gUERERERER0ylsioiIiIiIiOkUNkVERERERMR0CpsiIiIiIiJiOoVNERERERERMZ3CpoiIiIiIiJhOYVNERERERERMp7ApIiIiIiIiplPYFBEREREREdMpbIqIiIiIiIjpFDZFRERERETEdAqbIiIiIiIiYjqFTRERERERETGdwqaIiIiIiIiYTmFTRERERERETKewKSIiIiIiIqZT2BQRERERERHTKWyKiIiIiIiI6RQ2RURERERExHQKmyIiIiIiImI6hU0RERERERExncKmiIiIiIiImE5hU0REREREREynsCkiIiIiIiKm88jsAqRFYvQFduw5hNMNWGyUrvQA+QJ9MrtYyZyR7Nqyl1g3gIWg0jUpm9czs0uVSgbH92zhyMVoAHxzF+bBamUzuUxyY27O7FrP7rMxAFgDi9DswYrYUrGF2LBT7Dl4CocjCSfe1KhdiwCff/UhQtJBYtQpdoecwQWAhTJVapE7m7n1lobbRUR4OE63AYCPfyAB2bxNfY0M4Upi55Y/CI2xA5CnWEWqlsqfacUxIo+zausRkk9L3pStW5/C2SyZVp70lHB2Nxv2XcIAsPhTo0EdcnhldqnuLSdCNnP4XPL1gV+uItSsVgaPe3N3kmvEn97J1mPJ37vFvzB1HijOv+3qNuMYHNq1iVNhcQDkKlSWamULZXKZMp7FbrcbmV2Iu3Vi02zqtexNpN3A4unP5GWbeaZe0cwuFgBG5G88WOxxdjsAbLSZdpw5nXNldrFSx3Aw9ulGjFywHYD7mrzE/iUfoHNJFmQkMvvZujz/dQgAnlWfJ3TTp/imYhPbvhtJo+fex224seYqybqN66lSOMCEsjk5e3A7v6/byI7dIRw5doILly4TFRNPksOFh7c3ftkDyJuvIEWLl6JilWrUq9+AKiWC0/7aYrqTG0ZTt8U4og0AL+ZtOcOj5VKzp91eYtgRHm/WlD3nEwF47I0v+LxfS1NfIyMY8Zfo+HAtluy+AECLwV+yYFTnTCuPY9N4gh8eToIB2PLz4a7D9C6Zmiqpf4/jMztSqfePOAE8KvDr8a3UC9LZy0wfvVCPN+fsAKD0Q31Zv+Q9st+T9ZNuIs8eZO3v69iyYzeHj5zg7IWLRETFYk9yYPHwIpt/dnIHBVOkWAnK31+FWnXrU7tycbxt/759LvTQOn7dego34BFYjsdbVcPnytswOPhxE6oP3YQb8KwykGPrR5Hr3/c2TWMPWcRbMzfgBqx5qjJscBey//V5GC5eb1uDT1bsB+Ch5yewYmLPTCtrZvl3HxYMN06nE6fTAIsDt5GVcrOB0+HA4QBw43JnpbKlguHG7XYD4P63vodrObfRuGB91ke60/FFvPh49Tl6182ejq9hPrfbSVLyDotHGr9re/gxli5YwLIVK9mwZQcnLsXc9jkhu3dc/cNiIzB/cWrXa0CzFo/S/vHGBPtntWYJJy8+UollIck1vFUef50fJ/XFmpVOui47Z47uY8euEM6FXiYqOh5Pv+zkCipA2fsrUbFcCfw8U1dgw+3C4UgiKaXXRnocdg23i6jIcMLDk8NmTLzd/BfJIG7DuHIMzfxTVHJZ3AZgcUOmlyc9pbxXSP7gU/tenXtpc18NVoSl57nCkzd+PMOIR3KYutXE8yFsPxph3tdr8aFCjQfI6XX9scK45vrASOXOfW7Pb3yxeKNZJbyh4AoN6flkg7t6rjMujHU/L+LHpT/x+4bNHDh5CdcdvMUNa67+P1uuglSpUYeHm7ak3ZOtKVcw8K7Kkhb7F79HlQ7DAbDmKs26bRuoXvDWlciHf/2UF15diAPwL/MqjVpeGzYBtwun04kbsLjc9/Zh5A7Yj61h0ieTcQIeZTozYNA1YRMw3Hf/O7lXpHvYjA6/SJw97QdrDy8/gnIHpLlVzXAl8eO8Lzh8Me4ut2CjXsd+1CmcibXBRgKrJ7/Lr2dd5mzPkoMnXh9MdROzUdhPw+k2YVvyid6jFO/Nm0DF7Gm/Ck+4eJA+/QZzLtqBxeLB08M+okvdkqnYggWrzYo1HUYr/3Uw+U9zOziy8Rvad+rHvtD4a+6w4OHphbe3F56ennjYbFitFiwWC4ZhYLjduFxOHI4k7HY7SQ4XUecO8/P8w/w8/wuGF2nA9G9m8uQDBbNQy7pBdEQooaHJYTMyOv42j884TnscJ7b8QN9+b7F63/mbXAxYyFv6QYa+/xFPNSpHdu+sU/fodCaSmOS48nd0VGwmlkbk38Tg/OKhNO2/ApOuEMCjOEsPhdC0oHlH37O7f2P06A9M296NVOpgSX3YNNxEnd5M745d+GHHuevusnp44uPtnXwO87Bhs1qxWCxgGLgNNy6XC6fDQZLdjj3JQXz4WTb+/D0bf/6e98aUYviMH+jXtBQ+Hv+t6VLCD62j5oOPcDrKtD3y5mxFmHrqEN3utheD4cbp+utazoLNw5aFrjnAlZRAdEw0p0L+YPmKX9m0dRcHjh4nNCKaRIcFv+wB5C9cjLIVq1L/oSY88nBt8uXIjr+fb6ZWhKfz1YWL0c/UYcKvZ9O8pbIPD2DD0nfxT2PGM5yJzP30XRbvvHiXW/DkrZovZW7YJJE/5nzI+O2O2z/0TtgKU6rvIKqbEAb/knhmF6tWrUoOm56RRDnN2a4rMZo/1q3m6OUksHhQ78Xbt5hdx1aKd79eTKRJH92VcsWv5fmO47j0H8+bq6a9Qfchn3Ix/urButgDTXm6SwfqVilNvjxB5AgMIJuvD15entis4Ha5cTjsJMTHERMVSVjoRfZtW8O3X33Juv1huID4U2vp8WhT9s78leHNCmSRmc0MHI6rO3aSIzETy3JV0sWtDOrZh5krd2O/ZQu1waVD6+jfpi5TG7bn/c8n0bhotgwr561EHP+ZixFXf0w7N28n1ngGfzNPlkYii8cNY872kwAEVXuCT9/okqn7lpFwhhEvDuLP2KQ0bMVCle4fM/yxwlnqIunv3GEb6NvrA86n6Zhppec702lewdyWweRNB/H4i/0pE2dyS4TrGLM//ZHL//FzRVZ1aus8nmjbl72XrlYe5ihShS5du9K0XmUK5ctLjsAA/P188fbywmazgtuN05FEYkI8MTFRXA69xMlDO1gw9ysWr92Hw4CkiMO83a4eISNn8uWg1qmaT0EyTvzG8bQf9SsOAyw+NZm8cDTFs8KX5Ypm+YxP+HTOEvYdPML58NgbViJHR4QSHRHKwT1bWDz3c1738qNw8dLUfKg1r7w+iAcKZM68NlmnKvs2LFn5rCn/HpYAqjdsYvpmHTGX8U3PfTRhP62Cq/DrHfYmdOycTg7v6Te935qnJjtPrqOsiQdRd+Qmho35/ErQDChQkb5jJjGwQ238bnOk8SUbAYE5Cc5fiJJl76d2/cY89+rb/DRlOANHTuJIeBIJl4/ybvvWNN67ngcLZ4FQ5DzGhdCrATPs4mlcBplaexh3YRfPtmrL4r1/VaZZyVmwJJWrVOGBqhUpHJyD+MvnOLBnBzt37WL/8Ys4jSRC1sylc7NTzF8xn4YlcmbeGwAM+0Vmj/mECOfVU2nY5gV8tOZ1hjbKb2IYdHF4y+/8uGwPAIUd5TK/O5gzlk2/rGBNeFoqLqwkNXzHtCKlm8TzrF6+jKNpauzwoPkr6dTF2pqPZ98aa/52k5bz8+T0DZvZ7qtBy1ZWbvoSRiJ7fl/F6ZQg7ZO/Co2qFbz5b8saTB6f9DuweQeX44vJ4wnOnsahEkYSc0e9wsz1h+/u6fFHeKdXvytB0+admy6vvc/YwV0I8r7N+/f1xT8gkKDg/BQrWZbqdRrQtltf9v8yg5f7DWPDsQjczhi+GfkKNRvW5aUaubJ0ZZCZPHz8qVCxMrlj72ynj484z6GTf53DLAQULE3xPHc4L4AtH7nTkGxcYftZu+Z3kgBLNl/MrmtKNXci+9Yt4o1XX+OnkOsbySw2b3Lmzk2OAD98vL3xsEKS3U5CfAxhoaHE2V24kuI4cWAnJw7sZP70ibww4iNe69mewoEZO6VTOodNKzWbd+K5IhF39eyQ9UvYfCj0yrZMKZFXdj5fupUJjjs/0rtOzuHBRsPSWANrIksg/X48zLM3bZ0zODC1Gy3/tzalZbEy8/5cTN2bVmjYCMzzXznsSfow2Pf5AHZdTGmRsXjT/5PvGPZo8TRs04PmL46mSNEAHm43kgiHgZEYwtLfd/Hg03VNKXVaxPz2CfuuGc91PmQnmxPdPGjyzKx3zIhi2kvtWBJy9ST9cK/xzBzZjdwBfnhck4INw0VCTBRLJ71C91Hf4jIg6uR6ujw3ju2rxpIvE2tyN8z8H2NXhV4f/JwXmdi7K0+uXUKFvFlkxnGRLMlCcIuhfN/iFg9xnaR7hXJ8fTw56ees/iLz5j9HZk1MbPUOoGbd+tyXM40zTrvtbAi6+/FAZ3+ZwTchfw2x8qD+sB/5dNADeN91DaKNck17sHRlMA2rtWdPtAFJp5k34Vuem907fSuos5DshSvz7dJVd1yZ98ecobTo82nKXxYq9fiMpQMeuMNnW/BKx4qRjGWw7IN+dB89l+jEq72ofIJK0fXl/rzQsQUFc/rh6emBzWrDYgG324XL6cRujydk3RImT/yYZZuP4zTAcEYy9a0XWLl4OSuWfEHxtP7eUiGdw6aFdn3/R7u7fPZHL+y+EjYtZg2ys1jIGZS6WS5dCYE3bK04v20RL4/56sY/IEcYx0zqOvpPVvyD8uN/0/sNQv2vrbXwIGdwfvJngcagTGdEM//TiRyIMLfmwJ0UQrrOOWTzp0az5njctILBzdk9f/DnueRuxbacRWlSq+xNa06tgWXM7ZKIna0bQq6MEbJkb0jrpmkJmn9tyEbxKo9RKOg9Is4n1zYfPnE+7dtNI1f0UfoPmnddrac76gB9Bixg3aftyJ4JYe3Yiim8s/x08uQvNn+aDZzCrOHt/jGpB4DFYiNbQC46vD6ZvAGedHljLpeTDMI2f8b7szsxvnuVjK91N5I4uGIiL78zk6Tk9Sqo2bwj4eu/50isk6gTG+jScxizpoymcr7/QuC0UvP5cYzpWCWVz7OQs0TRf1ericWHjuMX8nyl1F6SWChZOXNb4v+Vks5zJvTqCct+bD+xbsiWFboLZhqDIweO8lcHdotPKfq9VB3vNF96WshWuCVNauVnzy/JY0Avn9lLosPA9wbH5lRzX+T9557l1/M37iIQH3bq6kNjztDv6SfJ7nXjL9q/ci9mj3si7WX6G4vFio/vnc9YHnru5DV/GRzcFQI+D/5nwjkAhp1tXw6k15jZRCcm/1aDStSiz+DX6d62CfkDbhcUc5K3XS8eeuI5Dm35ic8+Gs/UxZtxu52c2LqAFp3zsHDu+5RPSzNwKmTpbrQOx9Ura5vNJ2vN8gjEXTzG8uXLM7/r1T8YxMZc05/biCM61g2Z1eKSlRjRzJ80hsXHM2Cgupm8CjPi+8U3v99IZGb3urz4TfLSJ95lW/P94g/IuPlbbWT398RCYvJ+Zw8nKt4FPmm/enHY47FfMzbS1yezZ6V18/s3E/n6UAKQHNzAjWE42T+zO3PbP0CvxsUyvFSLflhObMqPPm/Vlnwzoh1+t5t23+bHQ32m8dTKP/jk56Ng2PllwRycXavgmYGHC7cjgU3fjaPlC2NJcBmAheyl2zNl7gwClntTvcdsIpNcHFgxkTZPnGP54imUzhPAv3BVgVSwkKtYJRo0uLvZNP9drBSqVJ8GDbLSan1uIkMvkmB2pXFSOOlWD32HEkO2seeamrL4c79wNsxJ3uAsfUmY7nx9vbCQPHGx4YzjQqQD/E3YJ912oqITrvzp4eWL1awLWiOR/ZvWsOZOrmkc8WzfuO6mdwcarc2bVOpuucL5dcWaa24wCFsxlfXnn6Npgax0fEhfl3f9SIs+04h2A1gJLNWSH375mtr5U3f9Y7F5UabOY0yo1Zjmw9rw1IR1xDldnFg9mTfGPcDi955Ol/L/XRY+shjEx10doO3l66dxm3fKSOTAwbCrYdN1mn0H42mT9+Ztof9VAQXKUqqAv8mtAB7k9c/oYO8gLOzqpCJJkRFEG5Bxy8p50vjZTmRfMI1oAwz7Dj4cO5sG73VP22frDOfb9wdzIvyv92aldqWyJpT3brk5tnw8fd/6ImU8lIVyrQZQ5sw8Fu46C4aDt/v2otCShbQukZFdCZzs2n8w5f8W6rfsQrY7TmJWOrZpzsSfP8UATuxezZczZ+Jzk+dfPrQnpeXRHNGnNjN80Ot8vWJTStCEgCJ1+fr7j6jgb4UOk/jsUAJdR3+H04BzOxZQr8Y+egwaxYg+j+Gn84KkByOU15uUZOaBzI6GZnPx24+rUtbJTWaPOc3aPUep2rRM5hUr01mo2Ogh8tm+47zLAOdpxnR9jUYL3qN4jjSEHHci6z7tw4Idfw0ns1CiXovbzmPw3+Rkx7QBLNh9/ezjhiOEyZO+pen/MiYYZT6D+dM/SQma4F+gCvMXf5HqoHkdqx8txixhRFgrXvtqPQYGq7+Zys5RT1M1AzoKZeHd3U1MzNUdztM/exaZgfKqkq0GkGgfcMP7jMhfqV2oFbtMnvX0ThgJl/ntz6hrbohn4y8bcdZv9s8v3Ihjy6rfCU28wdWj4eTg+ah/3p5ajh00zpLd3izUeGEyy96s++/qcnYDRkI0O89GX/nbdTKEbREGze9ypWVn2CFqlczzt1st1Bn6M6vfanjDzytn49E8UfcnvtpwGnDz08RXqHP+GCNfak/V8iXJE+h7h5+zQVzEBQ7v38OM94bz+YrdKRUnNvLVeZnHHkzNUjcmcify58qv6NRjDEciksNvztItmDLtHcoeL8aB1q+wPzyJyKNr6NHyMaZ/PZNW1QplzHHLiOBi6F/fv43SlSqlap8uV6EsXoAdsF/YS7/eL5pfxmu4HQmcOrSXn+ZPZezHszmf8Nfxx8J91R5j4twZNCnul3KbF23fnIKvlwe9x33Phdgk4i7s55NBHfl+TgveeO1lmtWvQdG8t147TkTAFR/KVz9tu65HluGM47PPF9Dt4TfI8R/uSputYieGd/+C/jO24XAbnN0wmZZPhDHizT7Uq1yWAnkC77g3hSM+gmOHQlg2awKjpy4lLuVaMEfplrzZt5F5F9+2+/jyQDxfmrW9THRx93KefWcRsW7AYqVy5VIc2H0Qu2GwYtq7TGndiOfrFMTj337Bdjv2vfy4dHvKHzbqdR9D3RImzLht8aHXm6/y5fwN7I83sF/axZj555j/TIF0vwbOwmHTweXLkVf+yhaU15wuU4aLQ3u2cyHqzmf7c587jD3r9ZW9qcgzR9lyKfKaWwxCfvmKiCFNyPP3rrTuc4x6vh2/nMv0zhOSBjGXTrP7UviVv434vcxbcJBHnr/5uE3TWXPw4cwvudjkMX46mQDuBHZ+N462iyeSPTAnJSrWoMGDtalcvgyFCuQjV2B2vDwsOB1JxEZFcP70CQ6E7Gbj2jVsP3CKqOhoEpKu7pdF6nTm9+VjKZAps1gYfDemJy+//z3R9pQyWQMZO2UCtXJZINezfD7+BA/3eA+nAZEn1vNUswfp++E3jO5aOwO+AyfuKx+VBW/v1NWAenp5caX/WDpyJoSxYs4UJk2by84jZ4mJt3NldRarD7Wee585/+tGkcC/jUex+tFi0DTWNWjMM0/1ZdOZeMDNuV3L6PfMSgJy5ad28w7079eLxpUKp++bkP+k+zpOYv7g2iZXHlnIW9TEBa7vwKmf32FVymzV1oDy5Pc8yNnLLk4sf4+35z3OR8+Uz3IV+xknG13HzmP/ocZMXHcaMDi+8TuebbOY7AEBFChxPw0bNqBqxXIULVKQoJyB+Hh6YLidxMVEcun8GY4cCGHLxrWs27afyOho4hKSrhxWPQNKM33uZGrl+u9+wjcTf+xnujzRjYNhyd2NPQNrMWXBV3zbpQYfb4rCHX2EgY/VJ/vS33mqdjoe46+rhTEyZZicY99KdlxMOaHbivFUz4cwqwOxV9GmPN84FwOXXAbDzm/friDh6R7pPjlYpoTNyL0reHrwJ7gAi1cwb06bxIN/7+LpOsXF0CtDtclZoIA56xI5E3l/QFdmrT9uxtayIINdK6dxMfr6rj8X9q/n253n6FOvUMYXyeJP5TrVCDRhb3PbY9i+YzcJqZhN+N5nEPLbVM5EXNuM7mTt9HGc7zSNAv6p/+AtHr5UuL8C2byuPSlaKV8o4JbByb9IA77euJWvJn3EF3MX8uepcBz2eMIvxRP+21m2/rYolSWxElTiAbo8+yIvv9CRAhk9g4WRyI6fv2XCh++zcN1h7H91a8lfkRHT5vN0vSJXylmr4+ssjYrm+bemcybGiT3mPB+81JqNP3Vn4Cu9aVmzRPpdxFlykiPQB87GAU5OHD6K0SzPHYfck8dO4Eg5q9py3McrLz2N703GFEWd+p1ps9dxo84QN2K/uJ8hb4xk174DHDh4mPD4649NFg8fKj/Uhl59+tG1+QM3rVS0WD0oUvtplm2swVeffcS0WT+w/1w0hstBVOgpfp49np/nTiBvkRKUK1OG1t2G0LdttX99rwXJCix4BxWjYsWK/+ogdnn/cp7q/SUxLsDiS+t3pvHEhfd49t3F4Ipn3ogXaFpjKa3LZuykS25HPIcP7CM2IO1Ln1y6Zmzk3fAMuI/xK7bw4PSJfPbFLDaGnMHhtBMVHkpU+Gr2b12dyi1a8M1Tgjadu9Pv1T5UK3DnE+WkjUFC+Bm2bNrCwRNniIx14BeYiyKl7qdWjSrkTesyM2Zx2wn55Sv6vDqSjWeTh8555ynP+AXfU7VgEIWnzGRt86f9UQlKAAAgAElEQVTZcSEOZ8xZXu7QhmOjxzOwc0OypcPEAs74uCvjVg1XPHYHGZ6U4k+fIibl/GrNVZTyecx8n16Uv78UliWXMQDH8SPEGtybYTMp8iyrV63CCVh8itDDfoMxEQmHuHBlISoPihQtdOuLBkccPRuXped1N1ppMuw7lg1/1KSSZ32uiK2MH7sguSXW6kfVqsHs2X4MV8IF3ug1mhabP6XEtRfsllx06fcmNWNuFN7cbFgwkzX70zj7p0dpPlywkgdzpn1vjj25lZp1Hubo5bQsev4Xg99GNsJnpAmb+pvgOs9wfM30DFm42Rm+ldFvfU2CG7B64GtzkeAwOL9nKZ/8coD/PXF/qi+QbDkK88X3K6hSOPVdE7MFlaL3iM/o9eZYNi6exaQv5rJh70kS7XaSkpw4nU5cbjeG4cYwwGKxYLFYsdpseHh44OnphbevP8WqPUTP3n3p8kiVjD1QGS7iYqI5d3ADI159hR+2nca40svTSkCBB5j0w0I6Vv1bN2MPfxq9NIEFwcE82fs9zkYlYDhi2PjDRP5Y8DmVHu3NhNF9qVAoD9n9fEwOQT6ULVWUH/eFAAabVy7E0bs2Xnf0xbtZvnLtlTX58paty9vDhuN9k9R3Yp2bWXPuPGx6585Ntj9/Y+Oeq928LRYb3tn8KVKxAYNHjqVLw5J33DXKP7gML4+cwosDhjD13eFMmPcLF8KjSXS4wO3g0okDXDp9gUeHTFXQFEnhSgxl1Kv92Z4yE3tgqdqM71KJgokDmT51ORsuO4g+s432jZ5gybqFNCmZcYHTfv5PWj1UO8Ne77Y8c9Gm99u06TWcA+sX8tmU6Szf8Ccx8XaSkpJwOl24XC7choGRfBLDYrFgs9qweXjg6emJl7cP+Us/QKduL9KrSzMCbjIDbHpIig9n1cxRPPvmVMIT/tlrzSdPOYZ9NovezSvgn4Hluo7hJi46jO/G9eGlDxZfOf/YfHLQf9x0etYMAiBPuZYsnz+SBo8O5VCknYSLexnd8zFWrB7OjHG9KZXXzCF2BpfOX7jamum+RHikG3wztorJ08f76rnL6TC9Z2VS4tW1iS2+PhlynZplu9Em7d3Gmb8aaqy5KFUqd7q8TqlGXRnXt00qnmGldIUsOiOW28GXI95mVcqU5jnvb84PC1+hXa0m7DhvJ+nQLAaOqs3CsddM2mLNTZdXh914e4aDsQdWpj1sSvoxXEwZNpTfUtZ7LFCzLTMfC+PRob9hd0UzsffTlAteTre6BTK8aBavAOq170O99i+TEB1BaFgYEZFRxMTGkWhPwuF0YriTlzWyeXji4+uLn78/gYE5CcqThxz+GTfO13AlcWL/djau38CaNWvYvieEw8fPkXRtHYxnAC16jmDckO6Uyet3021VbjuETZUaMW5IP6Ys3YMDMIwkdv84gYd/+oKiJctSqXodHnqoPvXr1qVc0TymDBF4tFkDxi8OwQ0c/P1rhv7Yk7FtStzmRGIQvukTJi/YnPK3hZqN2uBp5jSvHnl5Y9obzGswlNgcxajzUGNat2xO9cr3U65kYXzvsnbaI7AoL42dRddBZ9m/by9b1v7CkhW/sGXXYQKbDqRrLRPGuIjcAxIu7WfgM+2Z9XvKMhiWALq98R6FsnthC6jJ7IWf0PSxfhyNdOAO/4NnWj3Kax9/SZ/mpfH8L9fYWKyUrd+WT+o/yQcJMYSGhhEeEUlMbBwJCYkkOZy4U8KmzeaJt4832fz8CQjMSe7cQeTO4Z/hqyg4Iv7kxbad+G7DkZvOepwYup/hHeuxpN1rzJ46jPsyeE2R+AshTJ8wntkLVhJyMuxK0MyWpxxjv5hD92b3X/f4nDX78OPivHTv0INNFx1gJLF93nAarJlNo0e7MHhALx4oakbliIv9fx6+GjadpzlzNgHyJ5/vD6/8kKFT1v/jc3VeDDF1Fl+fsvdTwAYnXeCOCuH33fFUr27ShIPuMFavOZDyHi3kqlqdgAzI0lk0bBoc2rjpyjT+Fr/SVCh6m6JaLOTMkw+/62pprOQJuHWXhRyFytKqVau7KmXcxWOs2bb/JnfuIiojO3sbTo78+jFjZ69J+eF60Lbb8xTMW42BzzxCt/d+xImLnz4dSp9SJRnXtR7+/8WziMWXmk3bYLmUvmNUc5RJ/+57hjOOzXOG8L/Z65IPHBY/Or3QnwadC9L6u5r8sOsizoj9DHnxOQp8N5uHy+XJkBqsf7LgG5CLIgG5KHL7B2eK2At76NSqJbsuxP/jPu/sQVR4oCEDR46mXe07WTvUSp5SdRj/wx+0XzCJt8Z/yfa9R4ixu3AnxXJs3zaO7dvGolkTyVelIxt+nUEhExbmrNGxJ50//Zp5+yJxJ1xkYpcGBEydw8ttG5DL95/bN5Ji2LZyNt27vsnxuOTfg2+hh+jTq7XpXQX9q/Rn05Gu5M0bZPLvwoJ/UCFqNChEjQbNeXkYuBKjCE30IvA/PNHJHTHs7F2znGWH/vZtWzwoV6sexXPfQ7OXu2P449dlRAb8be/zyEHdpvXIedsd3uDylnn8b8xm04/rFv/8vPRiV3L4mH85ZridnNi1krf7vcx3W89hABarJw/1+Yh3OldKqeSyULBmVya+vZfnhk7hQryL8BNbeaNdTTb1HsHgnh2oVqqA6aEpLdded6po1VImbcmCp28ABYoEUCCrnsSApIhDDGrRmHk7UyZ2tPlStmpt6tWrSdHcvoSePsjmjevZuf80Se4kNn83hk4WP1ZMf4Ucd9YNJvUMN3FRYZw/f4ETh/awfMHXfLf0d0Jjrw77sVi9uP+hToz9ZDyNSwXe4DdmoVjtjqzaW5VhL/Xmi8UbiUpyE3nuEAs/H8GiGR9Ss2kbnun8JNXKFqdAgXzkyRmAR2p3WlcoazdHXTNOM4GD+49B9YoARJ7axYrly0ydjf1GrIWaUq+sPydDYsEdxtcfTaPnzH5kN+Ga/ezvc/lqd0pXc1sgnbs2Mm086K1k0bDpJMqnAg/Xj+Po0SOEFq5Chdt1c/fIxtvTFtO59n3X3+xz8xaItDq/bRFtn3wjS6yzeXLtTBp1eJtLCclR06dcdwb1eAgsVp4c+iGbfl/HxM0RGElhfNHvUaLDZjLj9cez6g6Qfiy5GTRxXmaXwgQGKycPptPrXxKfsi5h4cdHMaRTNSw2Cx988DrrHxnIRadB+KE1PFm/OqNmLuPV1vffdsv/RdkLVGTAo/fTbdqWK79nm08Omj09gLcHPUfZQrnvogXOg1pP9mdpi+c5s38940e9zZyVu0l0/VWLlo0nhoyloAlBE8CSvTzj5n7BpsadORqehOEK43+92jBjbGW69u5D+1YNKFEwF7EXT7Jl1RImfTqNP/afJD5lwiNbtryMm/EZ9fOlx1HBRnDeoHTY7g1eySeQLDn5dVbjDmd6n3ZM//vttuyMXbaBVxvdQ8tguE4ytHvbf9xsyV6D1efXU+cOftqXt87lna3mF82avxpdunYxPWy6484yZUgPRs/ZwOX4q/NfFG4ylBkjO+Fz7XWrxYPGvcaxMF8QLbq/Q6TdjeFMYNHEIfz81XiqNu3MiGEDaVg+n2nlK9WoKwsadTVtewK/zBjL1JSgafHKRf9pixnepir+PilxwjCwx0fx9Zge9PpgKQYGuxZ+wNQXO/DaTebzcETu4stPJ+F/zf5yacP5O77ujd8zh5qtXudifCIJiQk4Xdc/0y9/RUZOnc2zDUvh733r34AtoDRjZiylx44VvNi1FxtOJAdDIymazctmsXn5XHx8ffHNlp3hM1bwcrNyd1jKZO5Lx1h26tqGCIP9O7fBMxVTtZ00s+an7dOPMu+NrwEIWTaeqRseY+BDaVy/232ZIUM/IqUnPTnKNeDNBzNmibYsmjU8qffSByx7Kfkvt9t9RzXt2fwDyJHjP9Z1ypXIloWT6DN4DJdS+uZny1uBGfNGUSyln7nVpzBvfDGXPa078fuJaAxnPN+9/QxHtz3HW8Neo1nlAv/qSQ/+ayJPbWfS6KF8PHdNStCEvBVaM3/CswSmDHzL/2AvFn91mXa93udMTBJJMRd4o3MTfmnfnT4v9aJZ9aJp/vFv+uxFGr46M41bSSNrIIN+P8uYmmmsm7N403boKDbGzSWgVHkqValO3bq1KJDDO40tGRY8ff0pVq05ny5qxpizh9m44Q927tnL0bgCvPm4uVOO5ynXgkVzPqbvgLdZcyAUtyORs4c38+6Azbx741WaAMhZtDqDxkyg+4PFTSuP0x7D7p27ScjkZQoDC5aiYrHgzC2ESAaJvXiAie+PY/6iFYScjrjmHk+a9RzN5++/Qv4bVcZYPan2xGv8EXQfQ4aNYfHmo4BBQnQoG3/4hFfd/mz65m2yyLQypji/ewk1HmpPaHxmNhlYaT3qe354PY2tvM4TzJ6xKCUEetC8/0RGtK+B77VDIiwWvP1y0G34JC4f3MuwpSdwJ4UxfshUuq0ZRfAN6j3tF1fz9qDUTop0VbaKj/FcrdEMXRp+tSLXNydV6zbhyXbtePKxZhQLuvPAY/X0pWStJ/lld31WL1nI999/z/JVm7kQnQiGi8T4WNzZa9HwgdS3ap/Yu4tTfztf/bnzD5w8iwdQpvkgFv74NH+f4SR+8xS6jF5malfaJp3703rqIpYeT8CdcInh7VsTM/4ThnZrfFctkef2/srbfXvyw/YLyTdYA3h+wGv8vbNHesmiYfN6VmtKFDLcOBxO8PAiHSahSrWg8g0Z9957N7zPiD/EJ+9M52y69dY0SIi+yLfv9qb/hBVXWkts3rl5Yfw8Hit//RjX3KUas+yXmTR7uBsbT8eAYWf7j5N5fMlMHu07hvdfe4rCuXPgkQU+VzPtmv8OtZ4encmlsNL43fUsH/DAXW/BcDmJjYlk7dwx9BoymUvX9OPIXvRhZi37hqrXtUjZqNpuGL/6GLTo8RHHIxMwkiL4be5H/DZvAvc//DRvjxlFqyr5zVlS6B7gkb8RE2Y0SsdXsJKjYBladihDyw7p9BIWG6Ub92DJmod5v383pvwUQkRsPA7XPycAs1g98PUPpHi9p5kzbRTl8pjbHBh36QDdnmjK4fDMnTn6oX6f8/P73TO1DFmSJTvNe/Xlgb+vxWv1pnax9JkjIdNY89K1/wsU/ts1rcW7IIVu1rHAEsznu+P4PN0LZy5vDzerFi0h5HRMyi0WfHPdR49xc3i3a41bh0WLB8UbPMV3v7Xkh/cG8MZnSzgbHovLlotXBrx8TwXNe03ilpn8djgOAI/ghxk5rB03GD0BgMU3P30+n8RXZR/jYIybqG3TWXt4GO3LpsM3bM1B+yHDmL7tTax5S9Oi/bO83KMdxXKnbVZeq08eGrfvSeP2PXHHX+Knb75k6sxv2XHsMrVHTqZC7tTHm21/rEoJkhZsNgsul5sLO/9gebibx3JZCShUiSaFKv3jedH25aZ3r/fJX5Vv13xHg9qd2H4+Dlf0Ed7t+Sjzvu7JzI8HU+m+IPx8vLHc4oVdDjuxUaGsmv0ur4784sp61haPbDQa/CVvP1XD5FLfXJYKm26nneioSCIjIomMiiT88mUuXjjP+fPnOHf2DCdPnyMiMp6mY1bwet3MO+zFR5zn4IH9GLnK0b9//xs+xoj8la/HpE/YTIw4wXdTP2banIVsO3ThSi2L1SsnQ6b8wJCOZW/YUulZpBXzf1rMyJe78+WaU8mDnI0ElnwykA0bTrJj1Tjy+yh5ZD1uvh7TjXdnrebY2cs4r1y7Wwmu9SzfzBhF3fw3+ilbKdb6LVatqs/Y1/ry5W9Hkpe3MNzs/W0e797fkaaV83O3cwMEV2jACy9k8mRZFl9qBN9jNSQm8MpZjKGz1vD8ycMcPnyYndu2ceT0OUIvR+MTkIt8hUpQvXpVSpcpR7kS+TNpLK9kKqs/zV8eRu9S/4Fv35aX7gOHUy/PvX9+88xdlhkTn6dW24+IsAXS5qWhDHy+A1VL5r/zHkyeOWn75pc06naYLRtWsyGqAu1rZEw3+IyULXdRnnn2BWLSexDeLVmpWDWtA0Hd7Fq1NmW5DAvlWj1GpdvUHXoF1qNKuWAObjkP7ghCQk7QvmzpfzzOp+DjTP6kG4FXfjoGZxcNpd+sA3fclbZQ1U6s3fk4OXMEpkuDhjVbXlo+N4SWz71OXGQEbv9cqQ9/7tMsWZDSgutVgm49ijF78i84Eo4ybPgKmk1qRUZfHnvka8Z3i+cw+IUXWLg7DAMXJ1dPplmdbyhRpgxly1WmevXKlLqvADly5MDPC6IjIwk9f5I/d2xjz75DHDp0kFMXI6+sZ23xycfzYyYz5oVHMrTyKH3CZuIBRvcbx1EHgIHhduNyuXG5nDgcScRePHF1HRv7OfrWq8RLcdFExSVcXWLgpmzkOBiGYdLsmpFnDrBs2TLAwOVy4XQ4cCTZSUhIJD4umqioaCIuh3Hp0kXOnjnNyePHOH0p+YtrPWgGP4zpYko5UmPRx4PoOXbJdT/0PMVr0v/DGbzaouQtv9SgkvX4ZPkuarw7iI9mLuLAmXCs2UswatrI9Auajh00zqRBVH5BhalTp06mvPZVVsoXTMtkG1bK31+eE2e+x5lyMvHLU5THnx3IhJEv3GYmMQsFKjzMJ0v38Pic9/hgyrds/fMw1vuaMu9/TdI0o3exhk8xqeFTd78BSWdWgu8rQ/B9ZXiwSWvTtuqbqxRNm7cgzgDwJNj/xmHFwzcHDzVtSenYzB3VXrF8Oi4ALpLlWCnUYiRTppej+MPtqZDvLsdkWSzkKlSa5h1L0/wmD6nd+lneKPQIAEHF69x8qSUjknfrF2bEVjOWLEsLb2Zuu0znismVpIGFKvLuhxMzuUxmcHD8WNiVGUZLlrzNUoGAxebBfXmDgPOAm7BLocA/w6aHf3GatGxF3ivfrcHBg+OxwB2HTauHF3lyZUS0seCXI9ddPM/Nie/fY9mB5Jbh3LVaMaBHLX6atYpzcS6OzB7MH4Ma0qhYxk+aVqhyS75atZXqLz3B0G93Ja+NGR/BgZ2bOLBzE4tSMQWJxaMIn//0C93qFE2v4t5U+oRNT0/2r/qW70/fQbOe4eTyxYt3tl2LlaBCpSnsm5i28l3j8OpZPLl61l099/z5M6aVIzXa9h3Cl1OW8XukG6xeVOvwJjPe70fZWyzHcC2LzY+uQyfxZK83WfHV+6xNrEWP287A9O9UsuEzrFyZ8RUCf2e1pa0FsPKjPRla+0NGbIWHuw1hwvDnKRac885rCS02Gj/zBg3a9yX83CEOX/ajWJbq1yD/FsEVujBnQecrf1tu0o/HL6gUk2b9kFHFEkmTqHP7+HbRquuXO8oE+au1pG3dO5n1+la8ebRLN1PKcyt12/SkbmpWjpP0YRi4r0y8Y8HjDi8MbNarjzOMTN7xM5E75gyD/7cwpQLVyhMdWlCiZGkaFs3D1yEXcNmPM3HuShoNezJTyuflX4AuLSvx1re7brqczR3xLEmtKkVNKlXqpM/lpq0gpYr7YjkdBxawWG3YbFZsNo+URds98fTywsfHB19fX3x8sxEQEEhAQCCBgQEEBgYSGBhIQGAO8uTJS3C+YILz5adQocLkDjB7MfQ7ZLHi6xdAUN58FCxUiEKFClGxQQbPUJXCM+gBZi0Yx/C5Z3mkfRcea1AJr9QOvLPY8A8qTPuBn9A+Hcronb8iDRok/mMg9Y0kXT7B5pBTybVkNj8q133gmi4bN2exenBfUPbbPMaGV2YtWmwii2ceBn27hicdhShd6O7Xk/L08Se4eDWCb3AtE1S0Cl26JAdza/Z85MyWyoDsjCc8KiGdZ2e2EpAzp4ljtiN5pFQB1pxK36Vwbuf+RwezZf5o08bPRl08yrY/j2MAntlyU7NmVXxvcLQ/d2AL+85EA+BfoCI1ywffsKtd1Jm9zFrwG24DLF7+PN6xM/flyphZ7EQywuVjm3jjtUHEOjKzJd5CnYGFTAib/xTzx+e8MnXTHZ2T70be0g15e3B3st3wqtKDIlXr08DXcaM7b8tlP8/WLYdTlpywUqZaXYL97+Yk4EVev1scZN1JRETEpNtnlMxCtsBcNzwe3/0mPclfIHtKa6Obk6dCk5e5ucVTDLeLc+F/TSBlITCHGetUXnXqj/m8MOIfc11nLIs3zd/4lFcb3qp3i8GOHyew+kgYADafIjzZuDpWXz/eHNSKpc99QYzhZsXEd5jRoiHdH8idORnkGpZstVi0dw45jx5MHl4YFUNsXByJSS48vHwIyJGTvPkKULRESU599QydP96e6atmpFPbhg8jVl5mRPpsPG1sXnTo/Tr3PxZ93c0WixWbhw0PT2+8vb3x8fEle0AgOXLmJChPXvLnCyYgW1YZHm8hX71+TKuX3i/jQa+P5tNhtB0AT98brX90Y3la/Y+f73BytXNL3qZUu7E4AYtPcT5Y/gv10+mjNpJiuBQel+4/PL/AILKbejYBj+CKN+jkYp7itdsyo/Y/lwe4U0l7x1OhzhjSdT4YaxC/Hj5N/UIap3krB3+fSeuu7+E2IHfJJmz8YylFbzDt3MrPXuHFz7cDUKH7HDZ93v6G4zjCj2zmjddfw+EGS/aClHvosbsIm4kc2bGbsKTkyyC/ghWoWNiEbklx59i291RyF3OLN8WrVCWvd9o3m1qG20VSkh1sPnhnhRnsRK6ReHwD38z7Nm0tI7dQ/EFf3hzY/cZ3Wvx5auJy7nbQRczJqVQs15fzLgAPBk76kW4PmL+snev0j9Qp9xTH07Pu0ZKdsesv8Gp1M68PbFSrVwOvj7ZjNwx2r1nLJefTBN/iJZwJJ9l39FxKmXwpVaaoieWB+LBTrFmzxtRtpprFl6I9/rl29rUSTv5En/6fEuMwABvFu35M/RLJjRilO4+hw2cL+GJrBO7IfYzo+TINf5tF8RyZnQUsZM9ThFoFi1Drlo8zCM8i56L/Xkc6qydN2z1L08wuRwYyHLEc3LODHXv2cvToCc5fCiMqJo4khwubpzd+AYEEBeenaPHSVKxcleqVSuJjswIWcgQX5F5aTMaxcRzlWn2EPV1fxcKrM7YzukN6rlNncGzXeg5fvPWBNC0885anUdXCmV6Ll768qNO4Ff6hd5OQDbavXcn56OTa+nylqlO9zN2tQ3dfjXL3+OcMuM4y+olGfH3BBVi4f8g6to2skeb37TjwHS0bvk6UAdgK81nIQXoUS//eDC57LGdPHCXkz93s2LmDPSGHOHcxjAZ9pjP6qUpZ4/s0DJyG5Z6bZfyG3C5cFttd9w7IV74p8+b/cM0EbJkjZ4m7n7Vc/rsCG3WlZp5prLvkwh7yA6Nmv8wnz1a+8eRvRiK/v/ciey4kVz3YCj9O/QrptyZ9VmW4IhjSezA7k2dWIlvReswb3fxqhaslJ31fH8Ss9kNxGHBh3zI69hrPoplvUlBrOafKfy9s/kckRZ1j68bf+eHbeSxasY6zkQl3+EwL3jkK0eSxdjzV6QkerFGF4IBMaCZIN26cLmfKRDvpxYr79jNdpZHBt+++wIhFx9PtFXK2mciZb3ve8UHCGliapi1bYfZ8MHFhB1m/+Ug61chnY8SU+Xf5XAedaxZgwe7ksFnrycF8O6pN1ggZJrvuKzWMv99yT0iKOMumjRsxXC5cblfyhHFJdmKiIggLCyMsLIzQi+c5fuwox44d4+TZS9hvkEwCd4TgfqqSqTP8GkbKRHt/lcvhwJGUhN2eSGJiArExscTGxRIbE0vouRPs37eXP//8k70hx2k0aTtTH89rYmnSl2EYuN0u3C43TpcDp8NJUpIde6KdhIQ4YmNjiY2NJSY6inMnjxCy90/2/rmXvQfCePvXQ/SsfHetDtlyFeaRFvfuZFJ5uswirsvdzU9xM5++3IgB0zeaus3MZPEtQKOWrShvdoVD0nnW/LojZUxg+rD4VaNj23qsm7wWjFi+GdWTRuW/4fGaxfC89qTktrNp/ng6v78JuwHY/Gg/5BVKmDxBZNlHB2K3D7yr515YP5PijV/EBVh8CzF3yx+0LW3uMSwp+jTTBzzOF6sOp9ziRYfeg6n0tzFc5Vo8x0ed5jHwmxDs7iT2LBzFM9ksfPnhQIpmegvnv0eGhs3wMzv5afXe5B3Iw5smrZ4gX0AmL50A4HawYvZkNhy+BED+So15uUN6rreXvs7tmE+HLgPYczrshhdDt2ZgjzzNslkfsXzuZ+QpWZcPZs2hfZWge+Ii2rPOEA4e72v6dl2Jh2hTtzl/ZvKagpnJo1gnZv3QyfTtHl49grot3iX63ss3/xqOpGvG4hpuEjK7+ScdXNryNc0f+S452P31z+1OdcXRpZMHcbnBlubWRBerx3ah6KSUCxrDwMDAcBu4DTdut4H7r2DsdOJwOnE6nH8rr4WdO45hPJ43ax+/jQQ+71SKeVfe6t++g5Sg7Xa5cKa8V5fTeWU6/2Q2jhy5CJXv3cAo6cuaty6Tv19g+naN8O+pWPgpDqdXH2YALHTpO5iPpq/jqMMg9txuureoQ5NO/Rk2oDvl8/txZv8ffDb6LWav2nulUjhf+SaM7nB/1j4+mM0Ryv9eeJJxi0KurKuZr/lbjH6pyT8f65GLHlNWsuFoTb7echYw2DDvHWqvXcGspQtoVvbeWxIoPWRo2Dy9ZyH/b+/OA+ycD/2Pf86Zmex7iEQQS8QSxFLLzUJpuSVU9ab0qqul9uZXXSxX1VJVtbVaqqH9RUup3lKtokhR11ZS+xbtJa0gIrIgsmfm3D8SkV4JyeQ7sr1e/81kznOeMzlnzvN+zvf5fo878rzMrCX17Xvk5h32XjliszYvd19/RX4wakySZNuD2q2asVlrzP3XnJXDv3JB/jFtwUUHlWp699shu+06KAO23iIbb7BeeqzdLR3bt0tDXTVN8+Zk+tvTMnXSxIx7cWzGPPVY7r/7rjz+wutpbJydiX/9U47ce0heuPz6nPTJ/uGONsUAABZQSURBVKv8enyV1p3Sq1en4tttnDW14KQ1S6OSwcOG55tbTf3An3zx8dvzi5v/suBmrTPw37+YPTb+oOnBK2m7+Q5Lvy4bK60ZU8bmRxecnc6LOQn7xCPjl2obkya+uHBZqtrsWXnhjbeXe7/mTH0lL7zQjPXQ/o/GVyYVmdBj/jWXS3exVl2r9umxzjrp2atXeq+3QTbcaKNstPEm6devXzbffPNifwtmT5ucV6c1//b1rdtn9sSXMzf5UNdUW3a1vD351TT/WVVJm45dM3PqxNRSauh/Y24bcVrufGFOakk6b7Z/TjpySFancT4r0h0/+lL2O/GKJEnbDXbKYw+OSp+ufrvLo/0mH8+oW7+f/Q85LU9PeDtzp0/NrSPPzK0jz1zMT1eyzjafyCVXjMh6HdecQY6vPX1Tjv788Nz29ISFJ1B79B+a60ccm7WXsHZPtc1a+cEVP82s/zgsNz72WppqjXlzwot5dcr0JGJzaazSz7BKpS6tGhrSqpakvlWqS5iCf4VotUEOPOa4DGxMkmoGbNbyA7xnTrwvXz7pwoWh2bZb3xx7/hU5/eCd03aZKrExf7zs5Bz2jcvy+vS5mTVlbL518P7ZdPTjGbblh7/OEItTyZDPDM+QD/y5Wn5+4j35xcIv56Vx/X3yjdP2LH/ioGlGJr72ZkrPrfD65LdbeHbA1dvMKWNzyflnL8cWann+kQff/RRp3tv577+Mz1eH9F2ubf7t8oPS//Ll2MRyq6RDt7XTq1ev+V9V69LQqnXatG6d1m1ap3XrNuncbe307NkzPXv2Sq9ePdOrd59s0b9/+m3YM/Ut8nZTTeu2bdOu3eIOeiqpVOYvNVOpVFOtVlKt1qVaraauviHtO3fPBhttlI037putttk22263Q7bbqm/aN6xE74uLqtSlTbt2abeYPxjvLKdTqVRTqVZSrVRTraumrlqX+oZW6bxWr2y40UbZeNPNMmDAdtl++x2y5SY901At+Vib8ucbRuTie+ZfF7/ux/vkK0cMSeuV9Nf5geZOy/iJb/6fT4OXzxvTmz/7QS21NDXN/8veVHKnlkdtTiZNmJzmzZn7PpudOrWFL915RzXrDTkuf7xlvXzh0OPz3397LbPmvvcF1tCmfdbfdv/86leXZkCvNWtW8TYdu2XClGkLQ7NTn90y8sZrs+O67386rsumH8vPbrotn993/9z6zKTsfs5NOWRgn5bf4dXEKh2b6/TfK9fffHsaa0kq1fTt37zJOVpCpV2/fP3Ciz7Ee5yVW755ZJ6dPH+cRqXNprn4t7fm0F2aM6SoLnsec14e2nGnDP3kFzNm0pzU5r6Un4/8dYZ97/Cyu/0ha5r0UL538c3Fh2TWGidn/IyV5A1zEY2vjsrIax9c9Dv5y2Wn5vbPD84+m5RdW7VpynUZuMlRWZrldVmFzHomv/v944tcpTkvd199XV7+8q5Zb1V+B6m0yzH//w85ZkXvxyIq7TfIRTf9MW8vGKb87hqmlVSrlVSq1dTV1aW+vj719Q1p1ap1Wrdpk3bt2qdN6/oWHwpXa5ybqW/PS9fObZf7vqo9ds8v77p7/nVjWeSxVhbE5TuPtaE+DQ2t0qpVq7Ru0y7t27dLqzVixqOy5j15SbYf/K1MdeZuiWrT/5wDNt0ro0vX5oes21afzG/uHZQnH3sk9//pjjz01N/y+huz0nntdbPlR4Zk9yE7Z6fttky7VX2oWjN03mCX/Oaa8zL0U1/NW/0PzdUjv52B6y/duI+2a2+Za/54d+5+4Nn8y15lr8tfFdTmzsybs6vp0mHZRyCsyocKadOxR3b+l1Vn4oMWNXtc/ut34xaOP+/3he/m4GaF5jvq0nu7A/LZj/4gZ1w/f2mEp594OI05fLEvsBmTX8mLE99azL98sIkvTVrkerDZefG5MVmrWaOrK+nQq2/W77Lkp3Vt8qO59ILz8+oa8IY7d9rLOeOLX8no1+ckSerr6jKvsTFNbz6Rb33ju9n56rPSfSUYxU7L6tpncG648WdZv8N78+C6Mw7IKdc8teQb1+blocvPyx9fnvNP35757DX5+e1fz6lDN2x2dHTsOyhDNuuy3NFSe3NsRt03psWWdPhQVdtkk/4rZv3m91NrmpM//+rcfOmUH2bMazOyycADc/FPfpg9+i7H/19Dl2y+zeo01zktpaFd3+w37MC8UUuS+mzUdZU+dP1QNLTvnh0G75UdBu+1ondl5VKpS++BR+a6O3dI7622T7tl/APW0Kl39vxE78I7VcsbL/01r77P7IqTXnnz3ePkppl58bkx6bYUx2/jJi8yOWjTjIx9bkxqSxxoWck6ffql2/8ZWdM0a0puuvjEfO3C6zJ+ejXb7XdcRlx0agb0WvoZjL1iVxO1WdMyYdY7T8W6bL7Npsv/n1utZuPe745Hnz5t/mLH743NWp689lvZ5/Trm3U3tcY5C4de1mY+n+EfHdTMawXr8q8/fDbX/sfazbr1amXelFw+/FO5+E/zZ6utVNvk9FMOzwXf+XGm1ZInfn9RBh/YPndfe1LWKTwL3fw77JBzfz86B/QrfO6vWpeePX2qsSyqDW2ybu/1s/5i1tns1uH9z+jOnPS3nHTprQuGlVXyscE75q77RqdWm54rLzo3X//EiLRt1loTlfQZdl5uKLH0ySM/SO9BC5Y+oUVMmzA6w084P89Onv9MeP7+X+WwgxrywH0/zXptV9VxpWuw+v658tGbs9ti/iY0V12rdunYQicv26y9Ry65ao+W2fgStc7BIx/JGYMLP6hKNd16OvRe0TbdevsVvQuLmJtbT9ojX7p91hJ/ojZv9rvHybOeznFLeZzcuMjkfrXZf8nnPjbofd5zW+W7t/xPjv6Xjv/03TF3/jyfO/3qzF2woUd++/2c2LV3Ro340lLswXye8auJSvu1s+VadRk9vjFJYx666bZM+cLm6bYcx/q1xtl58OmxC7/u3qPHEp8wjXNnZfr06c2/s4V32pSZzd5OXWYty4UR1e753kPjMnyb1ell0JRJY+7KaSecnJ/f8XSaklQaumbYWddm+PG7pH/DxBx69m8yfe6cjP3DGdn3M3/Pt88+PXtus26z16dbvGrWWrdPNtxwdfrdrlmaZrySS756SB4eN3+Gmob198s5Fx+b4z8+NA9Oacq4B67Lwd/dL1f959CsQfNLrJGmPX97Xp76z2ML3xh/b8ZPnJX1+pQdjs+HoNKQbj17pVdnJwqWrJKO62yQDTc0aREtrZZ5s6Zn+vQlx+Y/a2zmcXJjZrzv7eZmTuN7j6H/56mHFobmfLU89+zDaUqW+oMhhwiri/r1c/QxO+WaM/6cubVaJtx2as4euX3O+eKQtGlGRTTOmZEnf/2VXH33O2sQVbLLoN2XeEakVYeuCyfaWHHq3vPx/5qi1tSY6W9NyaiRZ+TwU0dm5jvXQdW3zd7HnpOrvzZ/duV9vz4iZ78wPqf88s+ZNa+WJ0f9LJ++98Z84cyf5vTDPpoenTqk6BwbrJKa5s7IZSd/Madf90xqSaoN3fOVn/0k2/bvkgtP3z8f/9pvM6vx7fzh28NyVs9b853DdkursmcrWInUd1orraqVLDq7TF19u7Ru7RACYPlU0rbrOunZs/kTbpXRkPaLmZG3bYf3ruDQtl37ZRqV5J1iMab8/fFceeWVhbdayYYf+Vh26196rPe729/muCuy93Ufze+fei2pzctlJx2YR27ZN8ccf3wO+OjWabMUHdY0d0ae+NMN+dGPRuSGOx7OjAWf27ff/LP56hFLGvtfyY5H/jD/OPKHxR4NS6k2L8/cf0uuvuqq/OGuB/I/L0/JOyemGjr0yle+d0VOPHiRZXwaOuW4H9+YPgPOzKEn/Dhv12ppnDklI08elhsv3Ty77L5fjjji89lzp77+OKyhpr3yWE459uj88s4nFwy/qWTnz56Ybw7qkqSSbQ85Pwf+8uFcNfqlJE259ITP5a+PfDk/Pu+rWa/Tyr3ABs3Tre+w7LX9Jblm9Evzv1Fpk0FHnJt+PVz0DbB8WmXYFX/LsBW9G0uwyyf+PVuf+Ys8NW3BEUGlQ4Yd+sVVIzbnTZ+YT2xdfn2avc+8M789ZfByXQc0bvSNOWr0jcX2ab66/Nt5v2vB2EzqO26cy674QWYcdmL+9MzLaZw5NQ/e9os8eNsv8uWefTNw8MAM2HKz9Fl/3XTt1CGtGurSNHd23npjSl595R8Z89QTefCBBzL2tbcXmXmyLhvssE9GXntxBqy1mh1I1ubk2Xv/kFteaok5xSrp1HdQhmzWufiW5818I3fcdF3u/u97c+ftt+bpl976p6VBKnVtsuWg/XLquRfkgB16vXeYQ0OnDB1+YcYM3DnDv3ZORo1+LjMba5k0bkxuvnJMbr7ywvTo+5EMHbpXhuy2R4YNHdSMteVm56affDfj1mmBT5qra+UzXz06/Vp+NaHVwswpY3Pphd9Jl8Ws2fD4I6+++8W8mfnTVWfntDO/nydeWTDUplKfTQYflksvPD5tFnzk3dBxg1x81cUZ/8kjc8ffJqVx5qTcfsUZ2en+O/Kf3/p2hn9ql6X6dHz8qO/n+KnLf3117fUnF36ST8to6NA7l//upuw44oo88Py0fORfD8px/7571qTUHH/HCVmrzQnFt1tda+v85cl7slX3D3EJisbx+flZ38jdpddxqXTK5084OZt1Xbbtzhz3UPr1LL/+ddKQL9wwOZcPbc5Q2Hl5+Nrz8p3RLXB8UGmb3b9wZAau2/GDfxZWsM5998j9T9ydiy65Os9NachHDzwq//HxLZZpGz68WM103+bTueGunfNf3zsxJ190Q6bMmX8U9taE53Pb9c/ntmXYVqW+fQ457fKcO/yT6d6MqY5XerVpGfm1z2Rki2y8mq1PuS+jz9yhmZMdvc+Wa9Nzzbln59fPTHjPv62zxR654CeXZd8BvdP+fYe4VdNj+4Nyza37ZMx91+boo7+Rx155Z+2ppkx8fnR+9sPRueeZKfns0EHLvpO12bnx8rNT+pRNkqR+i2x1zFHp1xITG62GZkwZm4vP+/YH/2C1ktcevitPvhOaqWTDIUflll+fm426/POzuO1G++Tq316bz3xsaO6dMCdJLZP/em/uf+K1DD9gafaqlimP3pDLH13GB8MK09B9ixz7zQty7IreEZZf08T85kffL7/dunUz5KgTs1nX1WFRiHl55Jrv5JGW2HS1W+r3+uxKG5sde/bLTrvsksYkbfr0ycq6VO/Kor7XgHzqgAPSmKS67kdW3bV430fr3rvkP8/dpdm3/1Bjs0P3jTJk110zqwXPQm/VpxmfJFXqs+fBx6TDTq+X36GF91HNlrts0nLbX0Trzr1z6Fm/zL5HPp07Rt2R+/88Ok88/WxeGDsuk96avvhFnSuVdOiyTvpsvEn6bzUgOw4ckj332iubr9uhxddu+1BVqvPXqGvxpU+qqWuhix+r7XrlrFMPyO2HjMjbrbpky213zMAhg7PHnnvnYwO3ScdleGdoaNsx2+x5VB547sA8dOet+cMf78q999yXR8f8PbMaW+ffPn/EGreW1Bqr2iYHfefHuefRvXLd37vkiK+dmpOHH5QeSzjP1LXvrrn9yUfzo3POziVX3JCmAUflnBM+WfzkCqwYlWw4YHB2y6y05Afn1S4bp33Dmveq6da7X3bdddeWvZNKfTbrvub9bpfX1p8+K3d9ekXvxaqj3UcOyzW/OmxF78ZKrTJ79mwDkNYgM996PS+/PD6T35iW2XMbU9/QOh27rpV1e2+Q7p1arV5huTqrTcuTj4zNptsPSNsWeC+dM+3V3HPXcxmw7+5ZW20uQWN+es6Jeezl+TPIbfuvR+bI/bdb5V9DUyaMS6X7+um6DCctZk+bkImNHbJ+lw4tuGerntqctzLi/LPz+Lg3kiTb7HN4hn+q+WeHl1fjX3+bQ0/7ZebUklS75fAfjMjevVbPg/HX7rwgx18+ev417HV9ctZPLsgWBZf6gDXVq6POz7euf37+Unh9PpELv/HptC/40pr2j7/ku5f9ZsFs+p3zueP/X7ZaaxV9b6k15b8uPiOjnhyfJNlit0NywqG7f8CNVj9iEwAAgOJWz1OaAAAArFBiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcWITAACA4sQmAAAAxYlNAAAAihObAAAAFCc2AQAAKE5sAgAAUJzYBAAAoDixCQAAQHFiEwAAgOLEJgAAAMWJTQAAAIoTmwAAABQnNgEAAChObAIAAFCc2AQAAKA4sQkAAEBxYhMAAIDixCYAAADFiU0AAACKE5sAAAAUJzYBAAAoTmwCAABQnNgEAACgOLEJAABAcf8Lx8am18xjeZ4AAAAASUVORK5CYII="

# -------------------
# 질문 기록 CRUD 엔드포인트 및 모델 연동
# -------------------
# @router.post("/", response_model=schemas.QnA)
@qna_router.post("/")
async def create_qna(qna: schemas.QnACreate, db: Session = Depends(get_db)):
    """
    QnA creation endpoint:
    1. 세션 확인 또는 생성
    2. 모델 호출 (질문과 session_id 전달)
    3. QnA 데이터 생성 및 저장
    """
    try:
        # 1. 세션이 존재하는지 확인하거나 생성
        session = crud.create_session(
            db=db,
            user_email=qna.user_email,
            docs_id=qna.docs_id,
        )

        # 2. 모델 호출 (외부 서비스 연동) - chat_option에 따라 다른 함수 호출
        try:
            if "데이터 시각화" in qna.chat_option:
                # 데이터 시각화 요청인 경우 query_image 호출
                graph_response = await query_image(
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    pilot=qna_router.pilot
                )
                
                # 모델에서 반환된 전체 JSON 응답 저장
                answer = graph_response  # 전체 JSON 그대로 저장
                
            else:
                # 일반 질문 처리
                answer = await query_non_image(
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    pilot=qna_router.pilot
                )

                # 3. QnA 데이터 생성 및 저장 (session_id 및 chat_option 포함)
                new_qna = crud.create_qna(
                    db=db,
                    user_email=qna.user_email,
                    docs_id=qna.docs_id,
                    question=qna.question,
                    session_id=session.session_id,
                    chat_option=qna.chat_option,
                    source=answer["source"],
                    answer=answer["answer"]
                )
                
                return new_qna  # 프론트엔드로 그대로 전달
            
        except Exception as e:
            # Default value for qna_response to avoid UnboundLocalError
            
            if "데이터 시각화" in qna.chat_option and 'recursion' in str(e).lower():
                qna_response = {
                    "images": [
                        {
                            "file_name": "error.png",
                            "image_data": error_image,
                            "source": [],
                            "exception": str(e),
                        }
                    ]
                }
            elif 'recursion' in str(e).lower():
                qna_response = {
                    "answer": "관련 정보를 찾을 수 없습니다. 다른 질문을 해주세요.",
                    "source": [],
                    "ask_time": datetime.now(timezone.utc),
                    "exception": str(e),
                }
            
            else:
                qna_response = {
                "answer": "서버에서 예상치 못한 오류가 발생했습니다.",
                "images": [
                    {
                        "file_name": "error.png",
                        "image_data": error_image,
                        "source": [],
                        "exception": str(e),
                    }
                ],
                "source": [],
                "ask_time": datetime.now(timezone.utc),
                "exception": str(e),
            }
            return qna_response

    except ValueError as ve:
        raise HTTPException(status_code=400, detail=str(ve))  # 잘못된 입력 처리
    except Exception as e:
        # Default value for qna_response to avoid UnboundLocalError
        qna_response = {
            "answer": "서버에서 예상치 못한 오류가 발생했습니다.",
            "source": [],
            "ask_time": datetime.now(timezone.utc),
            "exception": str(e),
        }

        if "데이터 시각화" in qna.chat_option and 'recursion' in str(e).lower():
            qna_response = {
                "images": [
                    {
                        "file_name": "error.png",
                        "image_data": error_image,
                        "source": [],
                        "exception": str(e),
                    }
                ]
            }
        elif 'recursion' in str(e).lower():
            qna_response = {
                "answer": "관련 정보를 찾을 수 없습니다. 다른 질문을 해주세요.",
                "source": [],
                "ask_time": datetime.now(timezone.utc),
                "exception": str(e),
            }

        return qna_response
